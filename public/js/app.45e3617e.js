(function(e){function t(t){for(var r,i,o=t[0],s=t[1],u=t[2],d=0,p=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&p.push(a[i][0]),a[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);l&&l(t);while(p.length)p.shift()();return c.push.apply(c,u||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],r=!0,i=1;i<n.length;i++){var s=n[i];0!==a[s]&&(r=!1)}r&&(c.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={app:0},c=[];function i(e){return o.p+"js/"+({}[e]||e)+"."+{"chunk-2d0b3289":"ca0c20c5","chunk-2d216dc7":"8119e2f6"}[e]+".js"}function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=a[e]=[t,r]}));t.push(n[2]=r);var c,s=document.createElement("script");s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.src=i(e);var u=new Error;c=function(t){s.onerror=s.onload=null,clearTimeout(d);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),c=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+r+": "+c+")",u.name="ChunkLoadError",u.type=r,u.request=c,n[1](u)}a[e]=void 0}};var d=setTimeout((function(){c({type:"timeout",target:s})}),12e4);s.onerror=s.onload=c,document.head.appendChild(s)}return Promise.all(t)},o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/",o.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var l=u;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"19b3":function(e,t,n){"use strict";n("f5c1")},2895:function(e,t,n){},"3dba":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),a={id:"the-app"};function c(e,t,n,c,i,o){var s=Object(r["w"])("nav-bar"),u=Object(r["w"])("router-view");return Object(r["q"])(),Object(r["d"])("div",a,[Object(r["g"])(s,{id:"nav"}),Object(r["g"])(u,{id:"body"})])}var i=function(e){return Object(r["t"])("data-v-57100780"),e=e(),Object(r["r"])(),e},o=Object(r["f"])("â€¹ Back"),s=i((function(){return Object(r["e"])("span",null," WeGYB ",-1)}));function u(e,t,n,a,c,i){var u=Object(r["w"])("router-link");return Object(r["q"])(),Object(r["d"])("nav",{class:Object(r["m"])(["navbar",{big:!i.back}])},[Object(r["g"])(u,{to:{name:"Home"}},{default:Object(r["C"])((function(){return[o]})),_:1}),s],2)}var d={name:"NavBar",computed:{back:function(){return this.$route.meta.back}}},l=(n("5d55"),n("6b0d")),p=n.n(l);const f=p()(d,[["render",u],["__scopeId","data-v-57100780"]]);var h=f,b={name:"App",components:{NavBar:h}};n("ab6d");const v=p()(b,[["render",c]]);var g=v,m=n("9483");Object(m["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});n("d3b7"),n("3ca3"),n("ddb0");var j=n("6c02"),O={class:"seperated-flex"},w=Object(r["f"])("Ride"),k=Object(r["f"])("Settings"),y=Object(r["f"])("Help");function S(e,t,n,a,c,i){var o=Object(r["w"])("router-link");return Object(r["q"])(),Object(r["d"])("div",O,[Object(r["e"])("div",null,[Object(r["g"])(o,{to:{name:"Ride"}},{default:Object(r["C"])((function(){return[w]})),_:1})]),Object(r["e"])("div",null,[Object(r["g"])(o,{to:{name:"Settings"}},{default:Object(r["C"])((function(){return[k]})),_:1})]),Object(r["e"])("div",null,[Object(r["g"])(o,{to:{name:"Help"}},{default:Object(r["C"])((function(){return[y]})),_:1})])])}var T={name:"Home",components:{}};n("92d6");const M=p()(T,[["render",S],["__scopeId","data-v-3a5ca2a9"]]);var R=M,_={class:"seperated-flex"},x={id:"cover"};function q(e,t,n,a,c,i){var o=Object(r["w"])("stat"),s=Object(r["w"])("my-back"),u=Object(r["w"])("controls");return Object(r["q"])(),Object(r["d"])("div",_,[Object(r["g"])(o,{value:c.time,label:"Time"},null,8,["value"]),Object(r["g"])(o,{value:c.distance,label:"Distance",units:"M"},null,8,["value"]),Object(r["g"])(o,{value:c.speed,label:"Speed",units:"MPH"},null,8,["value"]),Object(r["g"])(o,{value:c.avgSpeed,label:"Average Speed",units:"MPH"},null,8,["value"]),Object(r["e"])("div",x,[Object(r["g"])(s),Object(r["g"])(u,{riding:c.riding,"onUpdate:riding":i.toggleRide},null,8,["riding","onUpdate:riding"])])])}var C={class:"ride-component"},P={class:"value"},E={key:0},D={class:"label"};function I(e,t,n,a,c,i){return Object(r["q"])(),Object(r["d"])("div",C,[Object(r["e"])("div",P,[Object(r["f"])(Object(r["y"])(n.value)+" ",1),n.units?(Object(r["q"])(),Object(r["d"])("span",E,Object(r["y"])(n.units),1)):Object(r["c"])("",!0)]),Object(r["e"])("div",D,Object(r["y"])(n.label),1)])}var A={name:"stat",props:{value:{type:String,required:!0},label:{type:String,required:!0},units:{type:String,required:!1,default:""}}};n("f46d");const B=p()(A,[["render",I],["__scopeId","data-v-5b87596e"]]);var H=B;function L(e,t,n,a,c,i){return Object(r["q"])(),Object(r["d"])("div",null,[Object(r["e"])("button",{class:Object(r["m"])(["play",{paused:n.riding}]),onClick:t[0]||(t[0]=function(){return i.toggleRide&&i.toggleRide.apply(i,arguments)})},null,2)])}var N={name:"controls",props:{riding:{type:Boolean,required:!0}},methods:{toggleRide:function(){this.$emit("update:riding",!this.riding)}}};n("19b3");const V=p()(N,[["render",L],["__scopeId","data-v-548a7a1d"]]);var W=V,J={class:"my-back"},F={ref:"myBack",autoplay:"",muted:"",playsinline:"true"};function $(e,t,n,a,c,i){return Object(r["D"])((Object(r["q"])(),Object(r["d"])("div",J,[Object(r["e"])("video",F,null,512)],512)),[[r["A"],c.showVideo]])}var G=n("1da1"),U=(n("96cf"),function(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))}),z=n("bee2"),Y=n("d4ec"),K=n("ade3"),Q=(n("e9c4"),Object(z["a"])((function e(t,n){var r=this;Object(Y["a"])(this,e),Object(K["a"])(this,"start",Object(G["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.pc.createOffer();case 2:return t=e.sent,e.next=5,r.pc.setLocalDescription(t);case 5:case"end":return e.stop()}}),e)})))),Object(K["a"])(this,"iceStateChange",(function(){var e=r.pc.iceGatheringState;console.log(e),"complete"===e&&r.getRemoteAnswer()})),Object(K["a"])(this,"getRemoteAnswer",Object(G["a"])(regeneratorRuntime.mark((function e(){var t,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=r.pc.localDescription,e.next=3,fetch("/api/v1/offer",{body:JSON.stringify({sdp:t.sdp,type:t.type}),headers:{"Content-Type":"application/json"},method:"POST"});case 3:return n=e.sent,e.next=6,n.json();case 6:return a=e.sent,e.next=9,r.pc.setRemoteDescription(a);case 9:case"end":return e.stop()}}),e)})))),Object(K["a"])(this,"stop",Object(G["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,U(500);case 2:r.pc.close();case 3:case"end":return e.stop()}}),e)}))));var a=new RTCPeerConnection({sdpSemantics:"unified-plan"});a.addEventListener("track",t),a.addTransceiver("video",{direction:"recvonly"}),a.addEventListener("icegatheringstatechange",this.iceStateChange);var c=a.createDataChannel("car");c.addEventListener("message",(function(e){n(JSON.parse(e.data))})),this.pc=a,this.cc=c}))),X={name:"my-back",data:function(){return{showVideo:!0,toggleTimeout:null,videoStream:new Q(this.receivedStream,this.receivedMessage)}},inject:["touchEvents"],methods:{peak:function(){var e=this;this.clearToggleTimeout(),this.showVideo=!0,this.toggleTimeout=setTimeout((function(){e.showVideo=!1,e.clearToggleTimeout()}),4e3)},toggle:function(){this.clearToggleTimeout(),this.showVideo=!this.showVideo},clearToggleTimeout:function(){this.toggleTimeout&&(clearInterval(this.toggleTimeout),this.toggleTimeout=null)},receivedStream:function(e){"video"==e.track.kind&&(this.$refs.myBack.srcObject=e.streams[0],this.peak())},receivedMessage:function(){this.peak()}},created:function(){var e=this;return Object(G["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,U(1e3);case 2:e.touchEvents.on("tap",e.peak),e.touchEvents.on("dbltap",e.toggle),e.videoStream.start(e.receivedStream);case 5:case"end":return t.stop()}}),t)})))()},unmounted:function(){var e=this;return Object(G["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.touchEvents.off("tap"),e.touchEvents.off("dbltap"),t.next=4,e.videoStream.stop();case 4:case"end":return t.stop()}}),t)})))()}};n("7c4a");const Z=p()(X,[["render",$],["__scopeId","data-v-d9f90e78"]]);var ee=Z,te=(n("a15b"),n("d81d"),function(){return(new Date).getTime()/1e3}),ne=function(e){var t=Math.floor(e/3600),n=Math.floor(e/60)%60,r=e%60;return[t,n,r].map(re).join(":")},re=function(e){return e<10?"0"+e:""+e},ae=function(e){var t=Math.floor(e),n=Math.round(100*e)%100;return re(t)+"."+re(n)},ce=function(e,t){var n=e.longitude,r=e.latitude,a=t.longitude,c=t.latitude,i=6371,o=ie(c-r),s=ie(a-n),u=Math.sin(o/2)*Math.sin(o/2)+Math.cos(ie(r))*Math.cos(ie(c))*Math.sin(s/2)*Math.sin(s/2),d=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),l=i*d;return l},ie=function(e){return e*Math.PI/180},oe=function(){function e(t){var n=this;Object(Y["a"])(this,e),Object(K["a"])(this,"updateDistance",(function(e){if(!(e.coords.accuracy>1e4)){var t=n.prevCoords;if(n.prevCoords=e.coords,t){var r=e.timestamp/1e3-n.startTime;n.distance+=ce(t,e.coords),n.speed=e.speed||0,n.avgSpeed=r>0?3600*n.distance/r:0}}})),this.callbackMethod=t}return Object(z["a"])(e,[{key:"start",value:function(){var e=this;this.callback||(this.startTime=te(),this.distance=0,this.speed=0,this.avgSpeed=0,this.callback=setInterval((function(){e.callbackWithStats()}),200),navigator.geolocation.watchPosition(this.updateDistance))}},{key:"stop",value:function(){clearInterval(this.callback),navigator.geolocation.clearWatch(this.callback),this.callback=null}},{key:"callbackWithStats",value:function(){var e=Math.round(te()-this.startTime);return this.callbackMethod({seconds:e,time:ne(e),distance:ae(this.distance),speed:ae(this.speed),avgSpeed:ae(this.avgSpeed)})}}]),e}(),se={name:"Home",components:{Stat:H,Controls:W,MyBack:ee},data:function(){return{riding:!1,tracker:new oe(this.updateRideStats),time:"00:00:00",distance:"00.00",speed:"00.00",avgSpeed:"00.00"}},methods:{updateRideStats:function(e){var t=e.time,n=e.distance,r=e.speed,a=e.avgSpeed;this.time=t,this.distance=n,this.speed=r,this.avgSpeed=a},toggleRide:function(){this.riding?(this.riding=!1,this.tracker.stop()):(this.riding=!0,this.tracker.start())}},beforeRouteLeave:function(e,t,n){var r=!this.riding||window.confirm("Do you want to cancel this ride?");r||this.tracker.stop(),n(r)}};n("aafa");const ue=p()(se,[["render",q],["__scopeId","data-v-686bd17e"]]);var de=ue,le=[{path:"/",name:"Home",component:R},{path:"/ride",name:"Ride",component:de,meta:{back:!0}},{path:"/help",name:"Help",component:function(){return n.e("chunk-2d216dc7").then(n.bind(null,"c3ef"))},meta:{back:!0}},{path:"/settings",name:"Settings",component:function(){return n.e("chunk-2d0b3289").then(n.bind(null,"26d3"))},meta:{back:!0}}],pe=Object(j["a"])({history:Object(j["b"])(),routes:le}),fe=pe,he=n("c8b5"),be=n.n(he),ve=Object(z["a"])((function e(t){var n=this;Object(Y["a"])(this,e),Object(K["a"])(this,"on",(function(e,t){n.events[e]=t})),Object(K["a"])(this,"off",(function(e){delete n.events[e]})),Object(K["a"])(this,"trigger",(function(e){e.target.matches("button")||n.events[e.type]&&n.events[e.type]()}));var r=new be.a.Tap({event:"tap",taps:1}),a=new be.a.Tap({event:"dbltap",taps:2});a.recognizeWith(r),r.requireFailure(a);var c=new be.a.Manager(t);c.add([a,r]),c.on("tap",this.trigger),c.on("dbltap",this.trigger),this.events={}})),ge=ve;Object(r["b"])(g).use(fe).provide("touchEvents",new ge(document.querySelector("#app"))).mount("#app")},"5d55":function(e,t,n){"use strict";n("8276")},"7c4a":function(e,t,n){"use strict";n("c794")},8276:function(e,t,n){},"8fe1":function(e,t,n){},"92d6":function(e,t,n){"use strict";n("eabc")},aafa:function(e,t,n){"use strict";n("3dba")},ab6d:function(e,t,n){"use strict";n("8fe1")},c794:function(e,t,n){},eabc:function(e,t,n){},f46d:function(e,t,n){"use strict";n("2895")},f5c1:function(e,t,n){}});
//# sourceMappingURL=app.45e3617e.js.map